> labels=c(rep("0",1000),rep("1",1000),rep("2",1000),rep("3",1000),rep("4",1000),rep("5",1000),rep("6",1000),rep("7",1000),rep("8",1000),rep("9",1000))
> acc=c()
> for(n in c(2,5,10,20,40,60,80,120,160,200))
+ {
+ 
+   proc.time()
+   nbrsp20 = matrix(0,40,10000)
+   for(i in c(1:10000))nbrsp20[,i]=findnns(p[1:n,],p[1:n,i])
+   proc.time()
+   results = apply(nbrsp20,2,function(x) classify(x,4)) ## with k = 4
+   t1=table(results,labels)
+   print(t1)
+   acc=append(acc,sum(diag(t1)))
+ }
       labels
results   0   1   2   3   4   5   6   7   8   9
      0 788 117  42  11  74  79  37  55  84  21
      1  61 661  26   6 186  19   3 211   8  30
      2  31  28 427 276  80 240 111  39 231 234
      3   6   3 167 455   4 108  58   8 111 263
      4  33  79  44   4 392  43   6 213  27  40
      5  27   2  89  44  21 192 130   5 227  39
      6  11   0  26  19   3 100 536   0  93  12
      7  14 100  24   2 205   7   3 410   2  92
      8  27   1  84  31  12 185 101   2 183  37
      9   2   9  71 152  23  27  15  57  34 232
       labels
results   0   1   2   3   4   5   6   7   8   9
      0 849  39  24   2  34  46  29  10  38   7
      1  19 945   0   0   4   0   1   6   3   5
      2  15   1 828  64   1  19   3  17  84  54
      3   2   0  25 843   0  18   4   3  55  49
      4  19   2   2   0 915  14   7  37   2  27
      5  34   0  10  13   5 737  17   3 178  19
      6  31   0   1   4   8  15 934   0  13   5
      7   3   4  30   4  19   2   0 883   2  66
      8  26   3  60  27   0 141   5   0 580  60
      9   2   6  20  43  14   8   0  41  45 708
       labels
results   0   1   2   3   4   5   6   7   8   9
      0 961   8  11   1   9   2   4   6  26   4
      1   2 983   2   1   4   0   0   5   3   4
      2   2   1 949  13   1   0   0   5  17   6
      3   0   1   3 935   0   6   0   0  10  21
      4   3   2   0   0 953   3   4   8   1  35
      5   0   0   1   6   2 978   3   1  20  18
      6   5   1   0   0   8   2 988   0   7   0
      7   3   3  17   2   5   0   0 960   1  28
      8  22   0  13  13   0   6   1   0 901  18
      9   2   1   4  29  18   3   0  15  14 866
       labels
results   0   1   2   3   4   5   6   7   8   9
      0 985   5   3   0   3   0   0   4   6   4
      1   1 988   2   1   3   0   0   4   1   1
      2   3   1 982  11   1   0   0   4   8   1
      3   0   0   1 975   0   1   0   0  10  14
      4   1   2   0   0 980   1   2   9   0  17
      5   0   0   0   1   0 991   5   0  17  18
      6   2   0   0   0   2   2 993   0   4   1
      7   3   2   5   1   3   0   0 970   0   4
      8   4   2   6   3   0   2   0   0 950   6
      9   1   0   1   8   8   3   0   9   4 934
       labels
results   0   1   2   3   4   5   6   7   8   9
      0 987   4   1   0   3   0   0   5   3   4
      1   4 994   1   0   3   0   0   6   3   1
      2   1   0 994   6   1   0   0   0   9   3
      3   0   0   0 986   0   4   0   0  11  16
      4   0   1   0   0 986   1   0   9   0  12
      5   0   0   0   2   0 992   3   0  12   7
      6   2   0   0   0   1   1 997   0   3   0
      7   2   1   2   1   3   0   0 976   1   2
      8   3   0   2   0   0   1   0   0 953   4
      9   1   0   0   5   3   1   0   4   5 951
       labels
results   0   1   2   3   4   5   6   7   8   9
      0 988   3   3   0   2   0   0   4   4   2
      1   4 995   1   0   3   0   0   6   1   1
      2   2   0 992   6   1   0   0   0  11   3
      3   0   0   0 983   0   2   0   0  12  15
      4   1   1   0   0 988   0   0   9   0  12
      5   0   0   0   4   0 995   3   0  12   5
      6   2   0   0   0   1   1 996   0   5   2
      7   1   1   2   1   3   0   0 977   1   3
      8   1   0   2   0   0   1   1   0 950   3
      9   1   0   0   6   2   1   0   4   4 954
       labels
results   0   1   2   3   4   5   6   7   8   9
      0 988   2   3   0   2   0   0   4   2   1
      1   5 996   1   0   3   0   0   8   1   1
      2   2   0 992   5   1   0   0   0  12   4
      3   0   0   0 986   0   3   0   0  12  15
      4   2   1   0   0 987   0   0  11   0  13
      5   0   0   0   3   0 995   3   0  12   5
      6   1   0   0   0   1   0 997   0   6   2
      7   0   1   2   1   4   0   0 972   1   2
      8   1   0   1   0   0   1   0   0 948   2
      9   1   0   1   5   2   1   0   5   6 955
       labels
results   0   1   2   3   4   5   6   7   8   9
      0 987   1   1   0   1   0   0   3   1   1
      1   5 997   1   0   4   0   0   8   1   2
      2   2   0 991   7   1   0   0   0  15   4
      3   0   0   0 986   0   3   0   0  13  15
      4   0   1   0   0 987   0   0  13   0  14
      5   0   0   1   2   0 995   2   0  11   7
      6   1   0   0   0   1   0 997   0   6   2
      7   1   1   2   1   4   0   0 973   0   3
      8   3   0   3   0   0   1   1   0 947   2
      9   1   0   1   4   2   1   0   3   6 950
       labels
results   0   1   2   3   4   5   6   7   8   9
      0 986   1   1   0   1   0   0   3   1   1
      1   6 997   1   0   4   0   0   8   2   1
      2   2   0 992   6   0   0   0   0  16   5
      3   0   0   0 988   0   3   0   0  15  18
      4   1   1   0   0 987   0   0  12   0  14
      5   0   0   1   2   0 994   2   0  12   5
      6   1   0   0   0   2   1 997   0   6   2
      7   0   1   1   1   4   0   0 973   0   4
      8   3   0   3   0   0   1   1   0 943   2
      9   1   0   1   3   2   1   0   4   5 948
       labels
results   0   1   2   3   4   5   6   7   8   9
      0 983   1   1   0   1   0   0   3   1   1
      1   7 997   1   0   4   0   0   8   2   2
      2   2   0 992   7   1   0   0   0  15   5
      3   0   0   0 987   0   3   0   0  15  20
      4   0   1   0   0 986   1   0  12   0  13
      5   0   0   1   2   0 993   2   0  12   5
      6   2   0   0   0   2   1 997   0   6   1
      7   2   1   2   1   4   0   0 974   0   4
      8   3   0   3   0   0   1   1   0 943   2
      9   1   0   0   3   2   1   0   3   6 947
> acc
 [1] 4276 8222 9474 9748 9816 9818 9816 9810 9805 9799